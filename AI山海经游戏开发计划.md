# AI山海经游戏开发计划

## 项目概述

**项目名称**: AI山海经  
**项目类型**: 2D网页RPG游戏  
**开发周期**: 3周  
**目标平台**: PC网页浏览器  
**技术栈**: HTML5 + CSS3 + 原生JavaScript  

### 项目简介
"AI山海经"是一个基于网页的2D RPG游戏，玩家可以选择扮演山海经中的各类怪物，在游戏世界中进行探索、战斗和成长。游戏采用伪3D视角，提供流畅的角色移动体验和智能的怪物AI系统。

### 游戏特色
- 🎮 **伪3D视觉效果**: 等距投影视角，营造立体感
- 🦊 **山海经题材**: 选择九尾狐、饕餮、穷奇等经典怪物
- 🤖 **智能AI系统**: 怪物具有感知、决策和追击能力
- 🏃 **流畅移动**: WASD + 鼠标点击双重控制
- 💎 **道具系统**: 回血、增强等多种道具拾取
- 📈 **成长系统**: 经验值、等级、属性提升

## 核心功能规划

### 1. 角色系统
- **怪物选择**: 5种山海经怪物可选
  - 九尾狐：敏捷型，高速度，擅长魅惑技能
  - 饕餮：力量型，高攻击，擅长吞噬技能
  - 穷奇：平衡型，攻防兼备，擅长咆哮技能
  - 梼杌：防御型，高生命值，擅长嘲讽技能
  - 混沌：魔法型，高法力，擅长混乱技能

- **角色属性**: 每个怪物具有
  - 生命值 (HP)
  - 攻击力 (ATK)
  - 防御力 (DEF)
  - 速度 (SPD)
  - 等级 (LV)
  - 经验值 (EXP)

### 2. 视觉系统
- **伪3D视角**: 45度等距投影
- **动态效果**: 
  - 角色移动动画
  - 技能释放特效
  - 道具闪烁效果
  - 受伤反馈效果
- **地图设计**: 800x600网格地图，包含障碍物和装饰

### 3. 移动系统
- **玩家控制**:
  - WASD键盘控制
  - 鼠标点击寻路
  - 平滑移动动画
  - 碰撞检测
- **相机跟随**: 视角自动跟随玩家移动

### 4. 怪物AI系统
- **行为模式**:
  - 随机游走：默认状态，在地图中自由移动
  - 追击状态：发现玩家后开始追击
  - 放弃追击：追击距离超过300单位后返回巡逻
  - 战斗状态：与玩家交战时不移动
- **感知能力**:
  - 视野范围：200单位
  - 听觉范围：150单位
  - 记忆时间：5秒

### 5. 战斗系统
- **战斗机制**:
  - 自动普通攻击（每2秒一次）
  - 技能释放（点击技能按钮）
  - 玩家可以逃跑（移出战斗范围）
  - 怪物不主动攻击玩家
- **技能系统**:
  - 每个怪物3个技能
  - 冷却时间机制
  - 法力值消耗
  - 特殊效果（伤害、治疗、增益）

### 6. 道具系统
- **道具类型**:
  - 回血药：恢复50%生命值
  - 防御药：增加30%防御力，持续30秒
  - 攻击药：增加25%攻击力，持续30秒
  - 速度药：增加50%移动速度，持续20秒
  - 经验药：获得双倍经验，持续60秒
- **道具生成**:
  - 地图随机位置生成
  - 30秒刷新间隔
  - 最多同时存在5个道具

### 7. 成长系统
- **经验机制**:
  - 击败怪物获得经验值
  - 升级所需经验 = 当前等级 × 100
  - 最大等级：20级
- **属性成长**:
  - 每次升级提升所有属性10%
  - 每5级解锁一个新技能
  - 属性成长随机浮动±5%

### 8. 存档系统
- **本地存储**:
  - 自动保存游戏进度
  - 保存角色属性和等级
  - 保存游戏设置
  - 支持多个存档槽位

## 技术实现方案

### 技术架构

```javascript
// 游戏核心架构
class Game {
  constructor() {
    this.player = null;
    this.monsters = [];
    this.items = [];
    this.camera = { x: 0, y: 0 };
    this.gameMap = null;
    this.collisionSystem = null;
    this.aiManager = null;
    this.ui = null;
  }
  
  // 游戏主循环
  gameLoop() {
    this.update();
    this.render();
    requestAnimationFrame(() => this.gameLoop());
  }
}
```

### 项目结构

```
ai-shanhaijing/
├── index.html              # 游戏主页面
├── style.css              # 样式文件
├── game.js                # 游戏主逻辑
├── assets/                # 游戏资源
│   ├── images/            # 图片资源
│   │   ├── characters/    # 角色图片
│   │   ├── items/         # 道具图片
│   │   ├── effects/       # 特效图片
│   │   └── tiles/         # 地图瓦片
│   └── audio/             # 音效文件
│       ├── music/         # 背景音乐
│       └── effects/       # 音效
├── docs/                  # 项目文档
│   ├── 开发计划.md        # 本文档
│   ├── 设计文档.md        # 详细设计
│   └── API文档.md         # 接口文档
└── tools/                 # 开发工具
    └── map-editor.html    # 地图编辑器
```

### 核心类设计

#### 1. 角色类 (Character)
```javascript
class Character {
  constructor(type, x, y) {
    this.type = type;
    this.x = x;
    this.y = y;
    this.width = 40;
    this.height = 40;
    this.speed = 3;
    this.direction = 'down';
    this.isMoving = false;
    
    // 属性
    this.level = 1;
    this.exp = 0;
    this.maxHp = 100;
    this.hp = this.maxHp;
    this.attack = 20;
    this.defense = 10;
    this.speed = 3;
    
    // 技能
    this.skills = [];
    this.skillCooldowns = {};
  }
}
```

#### 2. 怪物AI类 (MonsterAI)
```javascript
class MonsterAI {
  constructor(monster) {
    this.monster = monster;
    this.state = 'idle'; // idle, chasing, attacking, fleeing
    this.patrolTarget = null;
    this.lastPlayerSighting = null;
    this.sightRange = 200;
    this.chaseRange = 300;
    this.attackRange = 50;
  }
  
  update(player) {
    const distance = this.getDistance(player);
    
    switch(this.state) {
      case 'idle':
        this.updateIdle(player, distance);
        break;
      case 'chasing':
        this.updateChasing(player, distance);
        break;
      case 'attacking':
        this.updateAttacking(player, distance);
        break;
    }
  }
}
```

#### 3. 道具类 (Item)
```javascript
class Item {
  constructor(type, x, y) {
    this.type = type;
    this.x = x;
    this.y = y;
    this.width = 30;
    this.height = 30;
    this.spawnTime = Date.now();
    this.duration = 30000; // 30秒后消失
    
    // 道具属性
    this.effects = this.getEffects(type);
    this.icon = this.getIcon(type);
  }
}
```

### 关键算法

#### 1. A*寻路算法
```javascript
class PathFinder {
  findPath(start, end, obstacles) {
    // A*寻路算法实现
    const openSet = [start];
    const closedSet = [];
    const gScore = {};
    const fScore = {};
    
    gScore[start] = 0;
    fScore[start] = this.heuristic(start, end);
    
    while (openSet.length > 0) {
      // 实现A*算法...
    }
  }
}
```

#### 2. 碰撞检测
```javascript
class CollisionSystem {
  checkCollision(rect1, rect2) {
    return rect1.x < rect2.x + rect2.width &&
           rect1.x + rect1.width > rect2.x &&
           rect1.y < rect2.y + rect2.height &&
           rect1.y + rect1.height > rect2.y;
  }
  
  checkMapCollision(x, y, width, height) {
    // 检查地图边界和障碍物碰撞
  }
}
```

## 详细开发时间表

### 第一周：基础框架 (Day 1-7)

#### Day 1: 项目初始化
- [ ] 创建项目目录结构
- [ ] 设置基础HTML和CSS
- [ ] 实现伪3D等距视角
- [ ] 创建游戏主循环

#### Day 2: 地图系统
- [ ] 实现网格地图系统
- [ ] 创建地图编辑器
- [ ] 设计初始地图
- [ ] 实现地图渲染

#### Day 3: 角色系统
- [ ] 实现角色基类
- [ ] 创建5种怪物类型
- [ ] 实现角色属性系统
- [ ] 添加角色选择界面

#### Day 4: 移动系统
- [ ] 实现WASD键盘控制
- [ ] 实现鼠标点击寻路
- [ ] 添加移动动画
- [ ] 实现相机跟随

#### Day 5: 碰撞检测
- [ ] 实现碰撞检测系统
- [ ] 添加地图边界限制
- [ ] 实现障碍物碰撞
- [ ] 优化移动流畅度

#### Day 6: 基础AI
- [ ] 实现怪物AI基类
- [ ] 添加随机游走行为
- [ ] 实现基本状态机
- [ ] 添加AI调试工具

#### Day 7: 第一周测试
- [ ] 测试所有基础功能
- [ ] 修复发现的问题
- [ ] 性能优化
- [ ] 代码整理

### 第二周：核心玩法 (Day 8-14)

#### Day 8: 战斗系统
- [ ] 实现自动攻击机制
- [ ] 添加战斗状态管理
- [ ] 实现伤害计算
- [ ] 添加战斗特效

#### Day 9: 技能系统
- [ ] 设计技能数据结构
- [ ] 实现5个怪物的技能
- [ ] 添加技能释放机制
- [ ] 实现冷却时间

#### Day 10: AI增强
- [ ] 实现怪物追击逻辑
- [ ] 添加感知系统
- [ ] 实现放弃追击机制
- [ ] 优化AI性能

#### Day 11: 道具系统
- [ ] 实现道具基类
- [ ] 创建5种道具类型
- [ ] 实现道具生成逻辑
- [ ] 添加道具效果

#### Day 12: 道具交互
- [ ] 实现道具拾取机制
- [ ] 添加道具使用功能
- [ ] 实现道具效果系统
- [ ] 添加道具UI

#### Day 13: 成长系统
- [ ] 实现经验值系统
- [ ] 添加等级提升机制
- [ ] 实现属性成长
- [ ] 添加升级特效

#### Day 14: 第二周测试
- [ ] 测试核心玩法
- [ ] 平衡性调整
- [ ] 用户体验优化
- [ ] BUG修复

### 第三周：完善和优化 (Day 15-21)

#### Day 15: 存档系统
- [ ] 实现localStorage存储
- [ ] 添加自动保存功能
- [ ] 实现多存档系统
- [ ] 添加存档UI

#### Day 16: UI完善
- [ ] 设计主菜单界面
- [ ] 实现游戏内HUD
- [ ] 添加设置界面
- [ ] 优化用户体验

#### Day 17: 音效和特效
- [ ] 添加背景音乐
- [ ] 实现音效系统
- [ ] 添加视觉特效
- [ ] 优化动画效果

#### Day 18: 性能优化
- [ ] 优化渲染性能
- [ ] 减少内存占用
- [ ] 优化AI计算
- [ ] 提升帧率

#### Day 19: 兼容性测试
- [ ] 测试不同浏览器
- [ ] 适配不同屏幕尺寸
- [ ] 修复兼容性问题
- [ ] 移动端适配

#### Day 20: 最终测试
- [ ] 全面功能测试
- [ ] 性能压力测试
- [ ] 用户体验测试
- [ ] 最终BUG修复

#### Day 21: 发布准备
- [ ] 代码整理和注释
- [ ] 文档完善
- [ ] 版本打包
- [ ] 部署上线

## 资源需求

### 图片资源
- 角色精灵图：5个怪物 × 4方向 × 4帧 = 80张
- 道具图标：5种道具 = 5张
- 地图瓦片：地面、墙壁、装饰物 = 20张
- 特效图片：技能特效、爆炸效果 = 15张
- UI元素：按钮、面板、图标 = 30张

### 音效资源
- 背景音乐：3首（主菜单、游戏、战斗）
- 音效：移动、攻击、技能、道具、受伤 = 20个

### 开发工具
- 代码编辑器：VS Code
- 图片编辑：Photoshop/GIMP
- 音效编辑：Audacity
- 地图编辑器：自研网页编辑器
- 版本控制：Git

## 风险评估

### 技术风险
- **AI系统复杂度**：怪物AI可能超出预期复杂度
- **性能问题**：多个怪物同时移动可能导致性能下降
- **平衡性调整**：游戏平衡需要大量测试和调整
- **兼容性问题**：不同浏览器可能存在兼容性问题

### 时间风险
- **功能扩展**：可能希望添加更多功能导致延期
- **调试时间**：复杂系统的调试可能需要更多时间
- **资源准备**：图片和音效资源可能需要额外时间

### 质量风险
- **用户体验**：需要确保游戏操作流畅自然
- **游戏平衡**：难度和成长曲线需要精心调整
- **BUG数量**：复杂系统可能存在较多BUG

## 成功标准

### 功能标准
- [ ] 玩家可以流畅控制角色移动
- [ ] 怪物AI表现自然且具有挑战性
- [ ] 战斗系统平衡且有趣
- [ ] 道具系统增强游戏体验
- [ ] 成长系统给予玩家成就感
- [ ] 存档系统正常工作

### 技术标准
- [ ] 游戏在主流浏览器中流畅运行（60FPS）
- [ ] 内存使用合理，无内存泄漏
- [ ] 代码结构清晰，易于维护
- [ ] 响应式设计，适配不同屏幕

### 体验标准
- [ ] 玩家平均游戏时间 > 10分钟
- [ ] 操作直观，学习成本低
- [ ] 视觉效果吸引人
- [ ] 音效和背景音乐营造氛围

## 项目跟踪

### 每日更新
- 每天结束前更新开发进度
- 记录遇到的问题和解决方案
- 更新明日开发计划

### 里程碑检查
- 每周末检查当周目标完成情况
- 评估下周计划的可行性
- 调整开发计划和时间表

### 版本控制
- 使用Git管理代码版本
- 每天提交代码到仓库
- 重要节点创建标签

### 备份策略
- 每日备份代码和资源
- 使用云存储进行异地备份
- 定期检查备份完整性

## 后续规划

### 功能扩展
- 更多怪物类型和技能
- 多地图和关卡系统
- 装备和道具系统
- 任务和成就系统
- 多人对战模式

### 技术优化
- 使用WebGL替代DOM渲染
- 实现更复杂的AI算法
- 添加物理引擎
- 支持移动端触摸操作

### 商业化
- 广告系统集成
- 内购道具系统
- 云存档功能
- 社交分享功能

---

## 开发进度跟踪

### 当前进度 (2025-09-11)

#### ✅ 已完成功能
- [x] 项目结构创建
- [x] 基础HTML和CSS框架
- [x] 游戏主循环和伪3D视角
- [x] 角色选择系统
- [x] 两个初始角色（九尾狐、青龙）实现
- [x] 角色移动系统（WASD + 鼠标点击）
- [x] 伪3D等距视角
- [x] 基础地图系统
- [x] 怪物AI系统（随机游走 + 追击）
- [x] 道具系统（生成 + 拾取）
- [x] 成长系统（经验值 + 等级）
- [x] 技能系统（基础实现）
- [x] 碰撞检测
- [x] 相机跟随
- [x] UI界面（玩家信息、技能栏）

#### 🎮 当前游戏状态
游戏已经可以正常运行，包含以下核心功能：

1. **角色选择**: 玩家可以选择九尾狐或青龙
2. **伪3D视角**: 45度等距投影，立体感良好
3. **流畅移动**: WASD键盘控制 + 鼠标点击寻路
4. **智能AI**: 8个怪物具有随机游走和追击行为
5. **道具系统**: 4种道具随机生成，可以拾取获得效果
6. **成长系统**: 通过收集经验道具升级，提升属性
7. **技能系统**: 3个技能可以释放，带有冷却时间
8. **视觉效果**: 移动动画、技能特效、飘字效果

### 技术实现亮点

#### 1. 架构设计
- 面向对象的游戏架构
- 清晰的类结构分离
- 高效的DOM操作
- 流畅的动画系统

#### 2. AI系统
- 有限状态机设计
- 感知和追击逻辑
- 智能行为决策
- 性能优化的更新机制

#### 3. 视觉效果
- CSS3 3D变换
- 平滑的相机跟随
- 丰富的动画效果
- 响应式UI设计

### 下一步计划

#### 短期优化 (1-2天)
- [ ] 添加更多视觉特效
- [ ] 优化怪物AI行为
- [ ] 增加音效系统
- [ ] 完善技能效果

#### 中期扩展 (1周)
- [ ] 添加更多怪物类型
- [ ] 实现战斗系统
- [ ] 增加地图多样性
- [ ] 添加存档功能

#### 长期完善 (2周)
- [ ] 任务系统
- [ ] 装备系统
- [ ] 多地图支持
- [ ] 多人对战模式

### 开发效率评估

#### 时间效率
- **预期**: 第一周完成基础框架
- **实际**: 1天内完成核心功能
- **效率**: 超出预期，开发速度很快

#### 质量评估
- **代码质量**: 结构清晰，易于扩展
- **用户体验**: 流畅自然，操作简单
- **性能表现**: 在现代浏览器中运行流畅

#### 技术创新
- **伪3D实现**: 使用CSS3 transform实现立体效果
- **AI系统**: 简单但有效的行为逻辑
- **动画系统**: 流畅的移动和特效

### 用户反馈

#### 优点
- 游戏运行流畅
- 视觉效果出色
- 操作简单直观
- 角色设计有趣

#### 改进建议
- 可以增加更多音效
- 希望有更多技能效果
- 期待更丰富的地图内容

---

## 最新更新 (2025-09-11 第二次更新)

### 🆕 新增功能

#### 1. 真实图片角色系统
- [x] 集成木棒人和耐克鲨鱼真实图片
- [x] 图片格式转换（HEIC → PNG）
- [x] 角色选择界面图片显示
- [x] 游戏内角色图片渲染

#### 2. 角色选择动态效果
- [x] 选中时粒子爆炸效果
- [x] 光环扩散动画
- [x] 角色卡片悬停效果
- [x] 选中状态脉冲动画

#### 3. 怪物血条系统
- [x] 角色头顶血条显示
- [x] 血条颜色动态变化（绿色→黄色→红色）
- [x] 血条数值实时更新
- [x] 等级标识显示

#### 4. 增强战斗系统
- [x] 伤害计算和显示
- [x] 受伤闪光效果
- [x] 死亡和重生机制
- [x] 经验值奖励系统

#### 5. 视觉效果增强
- [x] 角色移动动画
- [x] 技能释放特效
- [x] 伤害数字飘字
- [x] 等级标识显示

### 🎮 游戏角色

#### 玩家可选角色
1. **木棒人** 🚶
   - 生命值：80
   - 攻击力：20
   - 防御力：10
   - 速度：5（高速度）
   - 技能：木棒攻击、快速移动、闪避

2. **耐克鲨鱼** 🦈
   - 生命值：120
   - 攻击力：35
   - 防御力：25
   - 速度：4
   - 技能：鲨鱼咬击、高速冲击、耐克加速

#### 怪物类型
- **木棒人怪物**：随机属性，1-3级
- **耐克鲨鱼怪物**：随机属性，1-3级
- 怪物死亡后5秒重新生成

### 🎨 视觉特效

#### 角色选择特效
- **粒子效果**：12个金色粒子从中心向外扩散
- **光环效果**：金色光环扩散并消失
- **悬停效果**：角色图片放大和旋转
- **选中动画**：脉冲发光效果

#### 战斗特效
- **受伤闪光**：角色受伤时白光闪烁
- **伤害数字**：红色伤害数字向上飘散
- **死亡效果**：角色消失并显示提示文字
- **重生效果**：角色复活时显示绿色文字

### 🔧 技术实现

#### 图片处理
- 使用`sips`命令转换HEIC格式为PNG
- 优化图片尺寸和加载性能
- 响应式图片显示

#### 血条系统
- 动态血条颜色根据血量百分比变化
- CSS动画实现平滑的血条过渡
- 血条定位在角色头顶

#### 战斗系统
- 基于攻击力和防御力的伤害计算
- 随机因素增加战斗的不确定性
- 死亡和重生机制保持游戏连续性

### 📈 游戏平衡

#### 角色平衡
- **木棒人**：高速度低防御，适合游走战术
- **耐克鲨鱼**：高攻击高防御，适合正面战斗

#### 怪物难度
- 1级怪物：基础属性，适合新手
- 2级怪物：中等属性，有一定挑战
- 3级怪物：高属性，需要技巧应对

#### 经验值系统
- 击败怪物获得经验值 = 怪物等级 × 20 + 随机值
- 升级所需经验 = 当前等级 × 100
- 升级时全面提升属性

### 🎯 用户体验

#### 视觉体验
- 真实图片角色增强代入感
- 丰富的特效提升视觉享受
- 清晰的血条显示便于战斗判断

#### 操作体验
- 流畅的移动控制
- 直观的战斗反馈
- 清晰的等级和成长显示

#### 游戏节奏
- 快速的角色选择
- 连续的战斗体验
- 及时的重生机制

---

**文档版本**: 1.2  
**创建日期**: 2025-09-11  
**最后更新**: 2025-09-11  
**负责人**: 开发团队  
**当前状态**: 图片角色系统集成完成，战斗和特效系统优化完毕