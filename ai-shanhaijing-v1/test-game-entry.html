<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIå±±æµ·ç» - æ¸¸æˆè¿›å…¥æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #007bff;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
            transition: background 0.3s ease;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-button.success {
            background: #28a745;
        }
        .test-button.success:hover {
            background: #1e7e34;
        }
        .status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .console-log {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            height: 200px;
            overflow-y: auto;
            margin-top: 20px;
        }
        .character-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .character-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .character-card:hover {
            transform: translateY(-3px);
        }
        .character-card.stickman {
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
        }
        .character-card.shark {
            background: linear-gradient(135deg, #4682B4 0%, #1E90FF 100%);
        }
        .character-card.coffee-ninja {
            background: linear-gradient(135deg, #4B0082 0%, #8A2BE2 100%);
        }
        .character-card.ice-camel {
            background: linear-gradient(135deg, #00CED1 0%, #20B2AA 100%);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® AIå±±æµ·ç» - æ¸¸æˆè¿›å…¥æµ‹è¯•</h1>
        <p style="text-align: center; color: #666;">æµ‹è¯•è§’è‰²é€‰æ‹©å’Œæ¸¸æˆè¿›å…¥åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>

        <div class="test-section">
            <h3>ğŸ§ª è§’è‰²é€‰æ‹©æµ‹è¯•</h3>
            <div class="character-grid">
                <div class="character-card stickman" onclick="testCharacterSelect('stickman')">
                    <div>æœ¨æ£’äºº</div>
                    <div style="font-size: 0.8em;">Lv.1</div>
                </div>
                <div class="character-card shark" onclick="testCharacterSelect('shark')">
                    <div>è€å…‹é²¨é±¼</div>
                    <div style="font-size: 0.8em;">Lv.5</div>
                </div>
                <div class="character-card coffee-ninja" onclick="testCharacterSelect('coffee-ninja')">
                    <div>å’–å•¡å¿è€…</div>
                    <div style="font-size: 0.8em;">Lv.4</div>
                </div>
                <div class="character-card ice-camel" onclick="testCharacterSelect('ice-camel')">
                    <div>å†°ç®±éª†é©¼</div>
                    <div style="font-size: 0.8em;">Lv.10</div>
                </div>
            </div>
            <div id="character-status" class="status info">ç‚¹å‡»ä¸Šæ–¹è§’è‰²å¡ç‰‡æµ‹è¯•é€‰æ‹©åŠŸèƒ½</div>
        </div>

        <div class="test-section">
            <h3>ğŸ”§ åŠŸèƒ½æµ‹è¯•</h3>
            <button class="test-button" onclick="testGameElements()">æ£€æŸ¥æ¸¸æˆå…ƒç´ </button>
            <button class="test-button" onclick="testGameClass()">æ£€æŸ¥Gameç±»</button>
            <button class="test-button" onclick="testSoundSystem()">æµ‹è¯•éŸ³æ•ˆç³»ç»Ÿ</button>
            <button class="test-button" onclick="testGameStart()">æµ‹è¯•æ¸¸æˆå¯åŠ¨</button>
            <div id="test-status" class="status info">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•</div>
        </div>

        <div class="test-section">
            <h3>ğŸš€ å¯åŠ¨æ¸¸æˆ</h3>
            <button class="test-button success" onclick="window.location.href='index.html'">å¯åŠ¨ä¸»æ¸¸æˆ</button>
            <button class="test-button" onclick="window.open('index.html', '_blank')">åœ¨æ–°çª—å£å¯åŠ¨</button>
            <div id="launch-status" class="status info">ç‚¹å‡»æŒ‰é’®å¯åŠ¨ä¸»æ¸¸æˆ</div>
        </div>

        <div class="console-log" id="console-log">
            <div style="color: #48bb78;">[æµ‹è¯•é¡µé¢] æ§åˆ¶å°å·²åˆå§‹åŒ–</div>
            <div style="color: #e2e8f0;">ç­‰å¾…æµ‹è¯•æ“ä½œ...</div>
        </div>
    </div>

    <!-- å¼•ç”¨æ¸¸æˆæ–‡ä»¶ -->
    <script src="game.js"></script>

    <script>
        let testGame = null;
        const consoleLog = document.getElementById('console-log');

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#f56565' : type === 'success' ? '#48bb78' : type === 'warning' ? '#ed8936' : '#e2e8f0';
            const logDiv = document.createElement('div');
            logDiv.style.color = color;
            logDiv.innerHTML = `[${timestamp}] ${message}`;
            consoleLog.appendChild(logDiv);
            consoleLog.scrollTop = consoleLog.scrollHeight;
            console.log(`[${timestamp}] ${message}`);
        }

        function updateStatus(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `status ${type}`;
        }

        function testCharacterSelect(character) {
            log(`æµ‹è¯•è§’è‰²é€‰æ‹©: ${character}`, 'info');
            updateStatus('character-status', `é€‰æ‹©äº†è§’è‰²: ${character}`, 'success');

            // æ£€æŸ¥Gameç±»æ˜¯å¦å­˜åœ¨
            if (typeof Game !== 'undefined') {
                log('Gameç±»å·²å®šä¹‰', 'success');

                // å°è¯•åˆ›å»ºGameå®ä¾‹
                try {
                    testGame = new Game();
                    log('Gameå®ä¾‹åˆ›å»ºæˆåŠŸ', 'success');

                    // æµ‹è¯•è§’è‰²é€‰æ‹©æ–¹æ³•
                    if (typeof testGame.selectCharacter === 'function') {
                        log('selectCharacteræ–¹æ³•å­˜åœ¨', 'success');

                        // å°è¯•é€‰æ‹©è§’è‰²
                        try {
                            testGame.selectedCharacter = character;
                            log(`è§’è‰²è®¾ç½®æˆåŠŸ: ${character}`, 'success');

                            // æµ‹è¯•æ¸¸æˆå¯åŠ¨æ–¹æ³•
                            if (typeof testGame.startGame === 'function') {
                                log('startGameæ–¹æ³•å­˜åœ¨', 'success');
                                updateStatus('character-status', `è§’è‰² ${character} é€‰æ‹©æˆåŠŸï¼Œå¯ä»¥å¯åŠ¨æ¸¸æˆï¼`, 'success');
                            } else {
                                log('startGameæ–¹æ³•ä¸å­˜åœ¨', 'error');
                                updateStatus('character-status', 'é”™è¯¯: startGameæ–¹æ³•ä¸å­˜åœ¨', 'error');
                            }
                        } catch (error) {
                            log(`è§’è‰²é€‰æ‹©å¤±è´¥: ${error.message}`, 'error');
                            updateStatus('character-status', `é”™è¯¯: ${error.message}`, 'error');
                        }
                    } else {
                        log('selectCharacteræ–¹æ³•ä¸å­˜åœ¨', 'error');
                        updateStatus('character-status', 'é”™è¯¯: selectCharacteræ–¹æ³•ä¸å­˜åœ¨', 'error');
                    }
                } catch (error) {
                    log(`Gameå®ä¾‹åˆ›å»ºå¤±è´¥: ${error.message}`, 'error');
                    updateStatus('character-status', `é”™è¯¯: ${error.message}`, 'error');
                }
            } else {
                log('Gameç±»æœªå®šä¹‰', 'error');
                updateStatus('character-status', 'é”™è¯¯: Gameç±»æœªåŠ è½½', 'error');
            }
        }

        function testGameElements() {
            log('æ£€æŸ¥æ¸¸æˆDOMå…ƒç´ ...', 'info');

            const elements = [
                'character-select',
                'game-screen',
                'game-layer',
                'camera',
                'ui-layer'
            ];

            let allExist = true;
            elements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    log(`âœ… å…ƒç´ å­˜åœ¨: ${id}`, 'success');
                } else {
                    log(`âŒ å…ƒç´ ä¸å­˜åœ¨: ${id}`, 'error');
                    allExist = false;
                }
            });

            if (allExist) {
                updateStatus('test-status', 'æ‰€æœ‰æ¸¸æˆå…ƒç´ æ£€æŸ¥é€šè¿‡', 'success');
            } else {
                updateStatus('test-status', 'éƒ¨åˆ†æ¸¸æˆå…ƒç´ ç¼ºå¤±', 'error');
            }
        }

        function testGameClass() {
            log('æ£€æŸ¥Gameç±»...', 'info');

            if (typeof Game === 'undefined') {
                log('âŒ Gameç±»æœªå®šä¹‰', 'error');
                updateStatus('test-status', 'é”™è¯¯: Gameç±»æœªåŠ è½½', 'error');
                return;
            }

            log('âœ… Gameç±»å·²å®šä¹‰', 'success');

            // æ£€æŸ¥å…³é”®æ–¹æ³•
            const methods = [
                'constructor',
                'selectCharacter',
                'startGame',
                'initializePlayer',
                'renderMap',
                'gameLoop'
            ];

            let allMethodsExist = true;
            methods.forEach(method => {
                if (typeof Game.prototype[method] === 'function') {
                    log(`âœ… æ–¹æ³•å­˜åœ¨: ${method}`, 'success');
                } else {
                    log(`âŒ æ–¹æ³•ä¸å­˜åœ¨: ${method}`, 'error');
                    allMethodsExist = false;
                }
            });

            if (allMethodsExist) {
                updateStatus('test-status', 'Gameç±»æ–¹æ³•æ£€æŸ¥é€šè¿‡', 'success');
            } else {
                updateStatus('test-status', 'Gameç±»éƒ¨åˆ†æ–¹æ³•ç¼ºå¤±', 'error');
            }
        }

        function testSoundSystem() {
            log('æµ‹è¯•éŸ³æ•ˆç³»ç»Ÿ...', 'info');

            if (typeof Game === 'undefined') {
                log('âŒ Gameç±»æœªå®šä¹‰ï¼Œæ— æ³•æµ‹è¯•éŸ³æ•ˆç³»ç»Ÿ', 'error');
                updateStatus('test-status', 'é”™è¯¯: Gameç±»æœªåŠ è½½', 'error');
                return;
            }

            try {
                const game = new Game();
                log('âœ… Gameå®ä¾‹åˆ›å»ºæˆåŠŸ', 'success');

                // æ£€æŸ¥éŸ³æ•ˆç›¸å…³å±æ€§
                if (typeof game.soundEnabled === 'boolean') {
                    log(`âœ… soundEnabled: ${game.soundEnabled}`, 'success');
                } else {
                    log('âŒ soundEnabledå±æ€§ä¸å­˜åœ¨', 'error');
                }

                // æ£€æŸ¥playSoundæ–¹æ³•
                if (typeof game.playSound === 'function') {
                    log('âœ… playSoundæ–¹æ³•å­˜åœ¨', 'success');

                    // æµ‹è¯•æ’­æ”¾éŸ³æ•ˆï¼ˆåº”è¯¥è¢«ç¦ç”¨ï¼‰
                    try {
                        game.playSound('test');
                        log('âœ… playSoundæ–¹æ³•è°ƒç”¨æˆåŠŸï¼ˆåº”è¯¥è¢«ç¦ç”¨ï¼‰', 'success');
                        updateStatus('test-status', 'éŸ³æ•ˆç³»ç»Ÿå·²ç¦ç”¨ï¼Œæ­£å¸¸å·¥ä½œ', 'success');
                    } catch (error) {
                        log(`âŒ playSoundè°ƒç”¨å¤±è´¥: ${error.message}`, 'error');
                        updateStatus('test-status', `éŸ³æ•ˆç³»ç»Ÿé”™è¯¯: ${error.message}`, 'error');
                    }
                } else {
                    log('âŒ playSoundæ–¹æ³•ä¸å­˜åœ¨', 'error');
                    updateStatus('test-status', 'é”™è¯¯: playSoundæ–¹æ³•ä¸å­˜åœ¨', 'error');
                }
            } catch (error) {
                log(`âŒ Gameå®ä¾‹åˆ›å»ºå¤±è´¥: ${error.message}`, 'error');
                updateStatus('test-status', `é”™è¯¯: ${error.message}`, 'error');
            }
        }

        function testGameStart() {
            log('æµ‹è¯•æ¸¸æˆå¯åŠ¨æµç¨‹...', 'info');

            if (typeof Game === 'undefined') {
                log('âŒ Gameç±»æœªå®šä¹‰', 'error');
                updateStatus('test-status', 'é”™è¯¯: Gameç±»æœªåŠ è½½', 'error');
                return;
            }

            try {
                const game = new Game();
                log('âœ… Gameå®ä¾‹åˆ›å»ºæˆåŠŸ', 'success');

                // æµ‹è¯•æ¸¸æˆåˆå§‹åŒ–
                if (typeof game.init === 'function') {
                    log('âœ… initæ–¹æ³•å­˜åœ¨', 'success');
                    try {
                        game.init();
                        log('âœ… æ¸¸æˆåˆå§‹åŒ–æˆåŠŸ', 'success');
                    } catch (error) {
                        log(`âš ï¸ æ¸¸æˆåˆå§‹åŒ–è­¦å‘Š: ${error.message}`, 'warning');
                    }
                }

                // æµ‹è¯•è§’è‰²é€‰æ‹©å’Œå¯åŠ¨
                if (typeof game.selectCharacter === 'function' && typeof game.startGame === 'function') {
                    log('âœ… è§’è‰²é€‰æ‹©å’Œå¯åŠ¨æ–¹æ³•å­˜åœ¨', 'success');

                    // æ¨¡æ‹Ÿé€‰æ‹©è§’è‰²ä½†ä¸å®é™…å¯åŠ¨ï¼ˆé¿å…é¡µé¢è·³è½¬ï¼‰
                    game.selectedCharacter = 'stickman';
                    log('âœ… è§’è‰²è®¾ç½®æˆåŠŸ', 'success');

                    updateStatus('test-status', 'æ¸¸æˆå¯åŠ¨æµç¨‹æµ‹è¯•é€šè¿‡ï¼Œå¯ä»¥å°è¯•å¯åŠ¨ä¸»æ¸¸æˆ', 'success');
                } else {
                    log('âŒ è§’è‰²é€‰æ‹©æˆ–å¯åŠ¨æ–¹æ³•ä¸å­˜åœ¨', 'error');
                    updateStatus('test-status', 'é”™è¯¯: å…³é”®æ–¹æ³•ç¼ºå¤±', 'error');
                }
            } catch (error) {
                log(`âŒ æ¸¸æˆå¯åŠ¨æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                updateStatus('test-status', `é”™è¯¯: ${error.message}`, 'error');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', function() {
            log('æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ', 'success');
            log('å¼€å§‹æ£€æŸ¥ä¾èµ–...', 'info');

            // æ£€æŸ¥æ˜¯å¦åŠ è½½äº†game.js
            if (typeof Game !== 'undefined') {
                log('âœ… game.jså·²åŠ è½½', 'success');
                updateStatus('launch-status', 'æ¸¸æˆæ–‡ä»¶å·²åŠ è½½ï¼Œå¯ä»¥å¯åŠ¨æ¸¸æˆ', 'success');
            } else {
                log('âŒ game.jsæœªåŠ è½½', 'error');
                updateStatus('launch-status', 'é”™è¯¯: æ¸¸æˆæ–‡ä»¶æœªåŠ è½½', 'error');
            }

            // æ£€æŸ¥å…¶ä»–ä¾èµ–
            const scripts = document.querySelectorAll('script[src]');
            log(`å‘ç° ${scripts.length} ä¸ªè„šæœ¬æ–‡ä»¶`, 'info');
            scripts.forEach(script => {
                log(`ğŸ“„ è„šæœ¬: ${script.src}`, 'info');
            });
        });

        // ç›‘å¬å…¨å±€é”™è¯¯
        window.addEventListener('error', function(event) {
            log(`å…¨å±€é”™è¯¯: ${event.message} (${event.filename}:${event.lineno})`, 'error');
        });
    </script>
</body>
</html>